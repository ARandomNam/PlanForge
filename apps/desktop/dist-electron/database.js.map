{"version":3,"file":"database.js","sources":["../electron/database.ts"],"sourcesContent":["import path from \"path\";\nimport { app } from \"electron\";\nimport fs from \"fs\";\n\n// Custom Prisma client import for production\nfunction createPrismaClient() {\n  const isDev =\n    process.env.NODE_ENV === \"development\" ||\n    (typeof app !== \"undefined\" && !app.isPackaged);\n\n  console.log(\"Creating Prisma client...\");\n  console.log(\"isDev:\", isDev);\n  console.log(\"process.resourcesPath:\", process.resourcesPath);\n\n  if (isDev) {\n    // In development, use normal import\n    console.log(\"Using development Prisma client\");\n    const { PrismaClient } = require(\"@prisma/client\");\n    return PrismaClient;\n  } else {\n    // In production, try to load from unpacked directory\n    console.log(\"Loading production Prisma client...\");\n\n    try {\n      const unpackedPath = path.join(\n        process.resourcesPath,\n        \"app.asar.unpacked\"\n      );\n      console.log(\"Unpacked path:\", unpackedPath);\n      console.log(\"Unpacked path exists:\", fs.existsSync(unpackedPath));\n\n      const prismaClientPath = path.join(\n        unpackedPath,\n        \"node_modules\",\n        \"@prisma\",\n        \"client\"\n      );\n      console.log(\"Prisma client path:\", prismaClientPath);\n      console.log(\n        \"Prisma client path exists:\",\n        fs.existsSync(prismaClientPath)\n      );\n\n      // Check if the unpacked Prisma client exists\n      const prismaGeneratedPath = path.join(\n        unpackedPath,\n        \"dist-electron\",\n        \".prisma\",\n        \"client\"\n      );\n\n      console.log(\n        \"Checking for generated Prisma client at:\",\n        prismaGeneratedPath\n      );\n      console.log(\n        \"Generated Prisma client exists:\",\n        fs.existsSync(prismaGeneratedPath)\n      );\n\n      if (fs.existsSync(prismaGeneratedPath)) {\n        console.log(\"Loading Prisma client from generated directory\");\n\n        // Set environment variables for Prisma\n        const queryEnginePath = path.join(\n          prismaGeneratedPath,\n          \"libquery_engine-darwin-arm64.dylib.node\"\n        );\n        console.log(\"Setting PRISMA_QUERY_ENGINE_LIBRARY to:\", queryEnginePath);\n        process.env.PRISMA_QUERY_ENGINE_LIBRARY = queryEnginePath;\n\n        // Load directly from the generated client\n        const { PrismaClient } = require(prismaGeneratedPath);\n        return PrismaClient;\n      } else if (fs.existsSync(prismaClientPath)) {\n        console.log(\"Loading Prisma client from unpacked @prisma/client\");\n        const { PrismaClient } = require(prismaClientPath);\n        return PrismaClient;\n      } else {\n        console.log(\"No unpacked Prisma client found, using fallback\");\n        // Fallback to regular import\n        const { PrismaClient } = require(\"@prisma/client\");\n        return PrismaClient;\n      }\n    } catch (error) {\n      console.error(\n        \"Failed to load Prisma client from unpacked directory:\",\n        error\n      );\n      console.log(\"Using fallback Prisma client\");\n      // Fallback to regular import\n      const { PrismaClient } = require(\"@prisma/client\");\n      return PrismaClient;\n    }\n  }\n}\n\nexport class DatabaseService {\n  private prisma: any;\n\n  constructor() {\n    // Initialize Prisma client with database path\n    const isDev =\n      process.env.NODE_ENV === \"development\" ||\n      (typeof app !== \"undefined\" && !app.isPackaged);\n\n    let dbPath: string;\n\n    if (isDev) {\n      // In development, use the project root directory\n      const projectRoot = path.join(__dirname, \"..\");\n      dbPath = path.join(projectRoot, \"prisma\", \"planforge.db\");\n    } else {\n      // In production, use user data directory\n      const userDataPath = app.getPath(\"userData\");\n      dbPath = path.join(userDataPath, \"planforge.db\");\n\n      // Copy database from resources if it doesn't exist\n      if (!fs.existsSync(dbPath)) {\n        const resourcesPath = process.resourcesPath;\n        const sourcePath = path.join(resourcesPath, \"prisma\", \"planforge.db\");\n\n        console.log(\"Copying database from:\", sourcePath);\n        console.log(\"To:\", dbPath);\n\n        try {\n          fs.mkdirSync(path.dirname(dbPath), { recursive: true });\n          fs.copyFileSync(sourcePath, dbPath);\n          console.log(\"Database copied successfully\");\n        } catch (copyError) {\n          console.error(\"Failed to copy database:\", copyError);\n          console.log(\"Creating new database...\");\n        }\n      }\n    }\n\n    console.log(\"Database path:\", dbPath);\n    console.log(\"Database path exists:\", fs.existsSync(dbPath));\n\n    try {\n      console.log(\"Initializing Prisma client...\");\n      const PrismaClient = createPrismaClient();\n      console.log(\"PrismaClient constructor obtained:\", !!PrismaClient);\n\n      this.prisma = new PrismaClient({\n        datasources: {\n          db: {\n            url: `file:${dbPath}`,\n          },\n        },\n      });\n      console.log(\"Prisma client instance created successfully\");\n    } catch (error) {\n      console.error(\"Failed to initialize Prisma client:\", error);\n      console.error(\n        \"Error details:\",\n        error instanceof Error ? error.message : String(error)\n      );\n      console.error(\n        \"Error stack:\",\n        error instanceof Error ? error.stack : \"No stack trace\"\n      );\n      throw new Error(\n        \"Database initialization failed. Please ensure Prisma client is properly installed.\"\n      );\n    }\n  }\n\n  async initialize() {\n    try {\n      // Test database connection\n      await this.prisma.$connect();\n      console.log(\"Database connected successfully\");\n      return true;\n    } catch (error) {\n      console.error(\"Database initialization failed:\", error);\n      throw error;\n    }\n  }\n\n  async disconnect() {\n    await this.prisma.$disconnect();\n  }\n\n  // Plan operations\n  async createPlan(data: {\n    title: string;\n    description?: string;\n    goal: string;\n    timeframe?: string;\n  }) {\n    return await this.prisma.plan.create({\n      data,\n      include: {\n        milestones: true,\n        tasks: true,\n        resources: true,\n      },\n    });\n  }\n\n  async getPlans() {\n    return await this.prisma.plan.findMany({\n      include: {\n        milestones: {\n          include: {\n            tasks: true,\n          },\n        },\n        tasks: true,\n        resources: true,\n      },\n      orderBy: {\n        updatedAt: \"desc\",\n      },\n    });\n  }\n\n  async getPlan(id: string) {\n    return await this.prisma.plan.findUnique({\n      where: { id },\n      include: {\n        milestones: {\n          include: {\n            tasks: {\n              include: {\n                dependsOn: {\n                  include: {\n                    prerequisite: true,\n                  },\n                },\n                dependencies: {\n                  include: {\n                    dependent: true,\n                  },\n                },\n              },\n            },\n          },\n          orderBy: {\n            order: \"asc\",\n          },\n        },\n        tasks: {\n          include: {\n            dependsOn: {\n              include: {\n                prerequisite: true,\n              },\n            },\n            dependencies: {\n              include: {\n                dependent: true,\n              },\n            },\n          },\n        },\n        resources: true,\n      },\n    });\n  }\n\n  async updatePlan(\n    id: string,\n    data: {\n      title?: string;\n      description?: string;\n      goal?: string;\n      timeframe?: string;\n      status?: string;\n    }\n  ) {\n    return await this.prisma.plan.update({\n      where: { id },\n      data,\n      include: {\n        milestones: true,\n        tasks: true,\n        resources: true,\n      },\n    });\n  }\n\n  async deletePlan(id: string) {\n    return await this.prisma.plan.delete({\n      where: { id },\n    });\n  }\n\n  // Milestone operations\n  async createMilestone(data: {\n    title: string;\n    description?: string;\n    targetDate?: Date;\n    planId: string;\n    order: number;\n  }) {\n    return await this.prisma.milestone.create({\n      data,\n      include: {\n        tasks: true,\n      },\n    });\n  }\n\n  async updateMilestone(\n    id: string,\n    data: {\n      title?: string;\n      description?: string;\n      targetDate?: Date;\n      status?: string;\n      order?: number;\n    }\n  ) {\n    return await this.prisma.milestone.update({\n      where: { id },\n      data,\n      include: {\n        tasks: true,\n      },\n    });\n  }\n\n  async deleteMilestone(id: string) {\n    return await this.prisma.milestone.delete({\n      where: { id },\n    });\n  }\n\n  // Task operations\n  async createTask(data: {\n    title: string;\n    description?: string;\n    planId: string;\n    milestoneId?: string;\n    priority?: string;\n    estimatedHours?: number;\n    dueDate?: Date;\n    order: number;\n  }) {\n    return await this.prisma.task.create({\n      data,\n      include: {\n        dependsOn: {\n          include: {\n            prerequisite: true,\n          },\n        },\n        dependencies: {\n          include: {\n            dependent: true,\n          },\n        },\n      },\n    });\n  }\n\n  async updateTask(\n    id: string,\n    data: {\n      title?: string;\n      description?: string;\n      status?: string;\n      priority?: string;\n      estimatedHours?: number;\n      actualHours?: number;\n      dueDate?: Date;\n      completedAt?: Date;\n      order?: number;\n      milestoneId?: string;\n    }\n  ) {\n    return await this.prisma.task.update({\n      where: { id },\n      data,\n      include: {\n        dependsOn: {\n          include: {\n            prerequisite: true,\n          },\n        },\n        dependencies: {\n          include: {\n            dependent: true,\n          },\n        },\n      },\n    });\n  }\n\n  async deleteTask(id: string) {\n    return await this.prisma.task.delete({\n      where: { id },\n    });\n  }\n\n  // Task dependency operations\n  async createTaskDependency(dependentId: string, prerequisiteId: string) {\n    return await this.prisma.taskDependency.create({\n      data: {\n        dependentId,\n        prerequisiteId,\n      },\n    });\n  }\n\n  async deleteTaskDependency(dependentId: string, prerequisiteId: string) {\n    return await this.prisma.taskDependency.delete({\n      where: {\n        dependentId_prerequisiteId: {\n          dependentId,\n          prerequisiteId,\n        },\n      },\n    });\n  }\n\n  // Resource operations\n  async createResource(data: {\n    title: string;\n    description?: string;\n    url?: string;\n    type: string;\n    planId: string;\n  }) {\n    return await this.prisma.resource.create({\n      data,\n    });\n  }\n\n  async updateResource(\n    id: string,\n    data: {\n      title?: string;\n      description?: string;\n      url?: string;\n      type?: string;\n    }\n  ) {\n    return await this.prisma.resource.update({\n      where: { id },\n      data,\n    });\n  }\n\n  async deleteResource(id: string) {\n    return await this.prisma.resource.delete({\n      where: { id },\n    });\n  }\n\n  // Settings operations\n  async getSettings() {\n    let settings = await this.prisma.settings.findUnique({\n      where: { id: \"settings\" },\n    });\n\n    if (!settings) {\n      settings = await this.prisma.settings.create({\n        data: { id: \"settings\" },\n      });\n    }\n\n    return settings;\n  }\n\n  async updateSettings(data: {\n    openaiApiKey?: string;\n    theme?: string;\n    language?: string;\n  }) {\n    return await this.prisma.settings.upsert({\n      where: { id: \"settings\" },\n      update: data,\n      create: { id: \"settings\", ...data },\n    });\n  }\n\n  // Statistics and analytics\n  async getPlanStats(planId: string) {\n    const plan = await this.prisma.plan.findUnique({\n      where: { id: planId },\n      include: {\n        milestones: true,\n        tasks: true,\n      },\n    });\n\n    if (!plan) return null;\n\n    const totalTasks = plan.tasks.length;\n    const completedTasks = plan.tasks.filter(\n      (task: any) => task.status === \"COMPLETED\"\n    ).length;\n    const totalMilestones = plan.milestones.length;\n    const completedMilestones = plan.milestones.filter(\n      (milestone: any) => milestone.status === \"COMPLETED\"\n    ).length;\n\n    const totalEstimatedHours = plan.tasks.reduce(\n      (sum: number, task: any) => sum + (task.estimatedHours || 0),\n      0\n    );\n    const totalActualHours = plan.tasks.reduce(\n      (sum: number, task: any) => sum + (task.actualHours || 0),\n      0\n    );\n\n    return {\n      totalTasks,\n      completedTasks,\n      taskProgress: totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0,\n      totalMilestones,\n      completedMilestones,\n      milestoneProgress:\n        totalMilestones > 0 ? (completedMilestones / totalMilestones) * 100 : 0,\n      totalEstimatedHours,\n      totalActualHours,\n      overallProgress: totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0,\n    };\n  }\n\n  async getDashboardStats() {\n    const plans = await this.prisma.plan.findMany({\n      include: {\n        tasks: true,\n        milestones: true,\n      },\n    });\n\n    const totalPlans = plans.length;\n    const activePlans = plans.filter(\n      (plan: any) => plan.status === \"ACTIVE\"\n    ).length;\n    const completedPlans = plans.filter(\n      (plan: any) => plan.status === \"COMPLETED\"\n    ).length;\n\n    const allTasks = plans.flatMap((plan: any) => plan.tasks);\n    const totalTasks = allTasks.length;\n    const completedTasks = allTasks.filter(\n      (task: any) => task.status === \"COMPLETED\"\n    ).length;\n\n    const overdueTasks = allTasks.filter(\n      (task: any) =>\n        task.dueDate &&\n        task.status !== \"COMPLETED\" &&\n        new Date(task.dueDate) < new Date()\n    ).length;\n\n    return {\n      totalPlans,\n      activePlans,\n      completedPlans,\n      totalTasks,\n      completedTasks,\n      overdueTasks,\n      taskCompletionRate:\n        totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0,\n    };\n  }\n}\n\n// Global database instance\nlet databaseInstance: DatabaseService | null = null;\n\nexport async function initDatabase(): Promise<DatabaseService> {\n  if (!databaseInstance) {\n    databaseInstance = new DatabaseService();\n    await databaseInstance.initialize();\n  }\n  return databaseInstance;\n}\n"],"names":["app"],"mappings":"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"}